function validateUserAdd(e){e.find("input:text").each(function(){var e=$(this).val(),s=$(this).prop("rel");"email"!=s&&e.length>s?$(this).removeClass("fc_invalid").addClass("fc_valid"):"email"==s&&isValidEmailAddress(e)?$(this).removeClass("fc_invalid").addClass("fc_valid"):$(this).addClass("fc_invalid").removeClass("fc_valid")});var s=e.find("input:password").eq(0).val();s==e.find("input:password").eq(1).val()&&5<s.length?e.find("input:password").removeClass("fc_invalid").addClass("fc_valid"):e.find("input:password").addClass("fc_invalid").removeClass("fc_valid"),0<e.find("#fc_group input:checked").size()?e.find("#fc_group").addClass("fc_valid").removeClass("fc_invalid"):e.find("#fc_group").removeClass("fc_valid").addClass("fc_invalid"),0<e.find(".fc_invalid").size()?$(".ui-dialog-buttonpane .submit").fadeOut(700):$(".ui-dialog-buttonpane .submit").fadeIn(700)}!function(e){e.fn.set_individual_buttons=function(s){s=e.extend({standard_class:"fc_checkbox_jq",individual_class:"fc_checkbox_ind"},s);var i=function(i){var a=match_class_prefix("set_advanced___",i);(a=e("#"+a)).children("input").size()==a.children("input:checked").size()?i.prop("checked",!0).addClass(s.standard_class).removeClass(s.individual_class):a.children("input").size()==a.children("input").not(":checked").size()?i.prop("checked",!1).addClass(s.standard_class).removeClass(s.individual_class):i.prop("checked",!0).addClass(s.individual_class).removeClass(s.standard_class)};return this.each(function(){var s=e(this),a=match_class_prefix("set_advanced___",s),c=e("#"+a);c.children("input").click(function(){i(s)}),s.change(function(){var e=s.is(":checked");c.children("input").prop("checked",e),i(s)}),i(s)})}}(jQuery),function(e){e.fn.set_list_click=function(s){var i={get_url:CAT_ADMIN_URL+"/groups/ajax_get_group.php",activity_message:"Loading group",addOnly:e(".fc_addGroup"),modifyOnly:e(".fc_modifyGroup"),get_id:"group_id"};return s=e.extend(i,s),this.each(function(){e(this).click(function(i){i.preventDefault();var a={id:(i=e(this)).children("input[name="+s.get_id+"]").val(),_cat_ajax:1};e.ajax({type:"POST",context:i,url:s.get_url,dataType:"JSON",data:a,cache:!1,beforeSend:function(e){e.process=set_activity(s.activity_message)},success:function(i,a,c){(a=e(this)).closest("ul").children("li").not(a).removeClass("fc_active"),e("#fc_list_add").removeClass("fc_active"),a.addClass("fc_active"),!0===i.success?(s.addOnly.hide(),s.modifyOnly.show(),(a=e("#fc_Group_form, #fc_User_form").find("input:checkbox")).not("[id*=fc_Group_m_], [id*=fc_Group_t_]").prop("checked",!1),a.filter("[id*=fc_Group_m_], [id*=fc_Group_t_]").prop("checked",!1),"group_id"==s.get_id?(e("#fc_Group_name").val(i.name),e("#fc_Group_group_id").val(i.group_id),e.each(i.system_permissions,function(s,i){e("#fc_Group_"+i).prop({checked:!0})}),e.each(i.module_permissions,function(s,i){e("#fc_Group_m_"+i).prop({checked:!0})}),e.each(i.template_permissions,function(s,i){e("#fc_Group_t_"+i).prop({checked:!0})}),e("div#fc_members").html(i.members)):(e("#fc_User_name").val(i.username).prop("name",i.username_fieldname),e("#fc_User_user_id").val(i.user_id),e("input[name=username_fieldname]").val(i.username_fieldname),e("#fc_User_display_name").val(i.display_name),e("#fc_User_email").val(i.email),e("#fc_User_password, #fc_User_password2").val(""),e("#fc_User_active_user").prop({checked:i.active}),e("#fc_User_otp").prop({checked:i.otp}),e("#fc_init_page").val(i.initial_page),e("#fc_init_page_param").val(i.initial_page_param),e("#fc_User_home_folder option").prop({selected:!1}).filter('[value="'+i.home_folder+'"]').prop({selected:!0}),e.each(i.groups,function(s,i){e("#fc_User_groups_"+i).prop({checked:!0})})),return_success(c.process,i.message)):return_error(c.process,i.message)}})})})}}(jQuery),jQuery(document).ready(function(){$("input[class*=set_advanced___]").set_individual_buttons(),$(".fc_group_list").children("li").set_list_click(),$(".fc_user_list").children("li").set_list_click({get_url:CAT_ADMIN_URL+"/users/ajax_get_user.php",activity_message:"Loading user",addOnly:$(".fc_addUser"),modifyOnly:$(".fc_modifyUser"),get_id:"user_id"}),$("#fc_list_add").click(function(e){e.preventDefault(),e=$(this),$("#fc_list_overview").children("li").removeClass("fc_active"),e.addClass("fc_active"),$(".fc_modifyGroup, .fc_modifyUser").hide(),$(".fc_addGroup, .fc_addUser").show(),$("#fc_Group_form, #fc_User_form").find("input:checkbox").prop("checked",!1),$("#fc_User_form select > option:first").prop("selected",!0),$('#fc_init_page > option[value="start/index.php"]').prop("selected",!0),$("#fc_init_page").val("start/index.php"),$("#fc_Group_name, #fc_Group_group_id, #fc_User_form input:text, #fc_User_form input:password").val("").filter("#fc_Group_name").focus()}).click(),$("#fc_Group_form input:reset, #fc_User_form input:reset").click(function(e){e.preventDefault(),$("#fc_lists_overview").find(".fc_active").click()}),$("input[name=addGroup], input[name=saveGroup]").click(function(e){e.preventDefault();var s=(e=$(this)).closest("form"),i={_cat_ajax:1};templates=[],modules=[],i[e.prop("name")]=e.val(),s.find("input[type=checkbox]:checked, input[type=text], #fc_Group_group_id").map(function(){var e=$(this).prop("name"),s=$(this).val();return"module_permissions[]"==e?i.module_permissions=modules.push(s):"template_permissions[]"==e?i.template_permissions=templates.push(s):i[e]=s}),i.module_permissions=modules,i.template_permissions=templates,console.log(i),$.ajax({type:"POST",context:e,url:CAT_ADMIN_URL+"/groups/ajax_save_group.php",dataType:"JSON",data:i,cache:!1,beforeSend:function(e){e.process=set_activity("Saving group")},success:function(e,s,i){!0===e.success?(return_success(i.process,e.message),"saved"==e.action?$("#fc_list_overview").children(".fc_active").children(".fc_groups_name").text(e.name):$('<li class="fc_group_item icon-users fc_border fc_gradient1 fc_gradient_hover"><span class="fc_groups_name">'+e.name+'</span><input type="hidden" name="group_id" value="'+e.id+'" /></li>').appendTo("#fc_list_overview").set_list_click().click()):return_error(i.process,e.message)}})}),$("input[name=addUser], input[name=saveUser]").click(function(e){e.preventDefault();var s=(e=$(this)).closest("form"),i={_cat_ajax:1,home_folder:$("#fc_User_home_folder option:selected").val()},a=[];i[e.prop("name")]=e.val(),s.find("input[type=checkbox]:checked, input:text, input:password, select, #fc_User_user_id, #fc_User_fieldname").map(function(){var e="groups[]"==$(this).prop("name")?"groups":$(this).prop("name");return i[e]="groups[]"==$(this).prop("name")?a.push($(this).val()):$(this).val()}),i.groups=a,$.ajax({type:"POST",context:e,url:CAT_ADMIN_URL+"/users/ajax_save_user.php",dataType:"JSON",data:i,cache:!1,beforeSend:function(e){e.process=set_activity(cattranslate("Saving user"))},success:function(e,s,i){!0===e.success?(return_success(i.process,e.message),"saved"==e.action?($("#fc_User_fieldname").val(e.username_fieldname),$("#fc_User_name").prop("name",e.username_fieldname),$("#fc_list_overview").children(".fc_active").children(".fc_display_name").text(e.display_name),$("#fc_list_overview").children(".fc_active").children(".fc_list_name").text(e.user_name)):$('<li class="fc_group_item icon-user fc_border fc_gradient1 fc_gradient_hover"><span class="fc_display_name">'+e.display_name+'</span><br/><span class="fc_list_name">'+e.username+'</span><input type="hidden" name="user_id" value="'+e.id+'" /></li>').appendTo("#fc_list_overview").set_list_click({get_url:CAT_ADMIN_URL+"/users/ajax_get_user.php",activity_message:"Loading user",addOnly:$(".fc_addUser"),modifyOnly:$(".fc_modifyUser"),get_id:"user_id"}).click()):return_error(i.process,e.message)}})}),$("#fc_removeGroup, #fc_removeUser").click(function(e){e.preventDefault();var s={id:"group"==(e="fc_removeUser"==$(this).prop("id")?"user":"group")?$("#fc_Group_group_id").val():$("#fc_User_user_id").val()},i=$("#fc_list_overview").children(".fc_active");dialog_confirm("Do you really want to delete this "+e+"?","Removing "+e,CAT_ADMIN_URL+("group"==e?"/groups/ajax_delete_group.php":"/users/ajax_delete_user.php"),s,"POST","JSON",!1,function(e,s,i){e=$(this),1==$("#fc_list_overview").children("li").size()?$("#fc_list_add").click():e.is(":last-child")?e.prev("li").click():e.next("li").click(),e.remove()},i)}),$("ul.fc_groups_tabs").find("a").click(function(e){e.preventDefault();var s=(e=$(this)).closest("ul").find("a").not(e),i=e.prop("href"),a=$(".fc_toggle_tabs");s.removeClass("fc_active"),e.addClass("fc_active"),a.hide(),$(i.substring(i.indexOf("#"))).show()}).filter(":first").click()});